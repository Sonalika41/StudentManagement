<h3>My Class Students</h3>
<p class="err" *ngIf="error">{{ error }}</p>

<div *ngIf="data">
  <p><strong>Class:</strong> {{ data.name }} ({{ data.section }})</p>
  <p><strong>Student Count:</strong> {{ data.studentCount }}</p>

  <table>
    <thead>
      <tr>
        <th>Full Name</th>
        <th>Email</th>
        <th>Marks</th>
        <th>Attendance %</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let s of data.students">
        <td>{{ s.fullName }}</td>

        <td>
          <span *ngIf="editingStudent?.studentID !== s.studentID">{{ s.email }}</span>
          <input *ngIf="editingStudent?.studentID === s.studentID"
                 [(ngModel)]="updatedEmail" name="email" />
        </td>

        <td>
          <span *ngIf="editingStudent?.studentID !== s.studentID">{{ s.marks }}</span>
          <input *ngIf="editingStudent?.studentID === s.studentID"
                 [(ngModel)]="updatedMarks" name="marks" type="number" />
        </td>

        <td>{{ s.attendancePercentage }}</td>

        <td>
          <button *ngIf="editingStudent?.studentID !== s.studentID" (click)="editStudent(s)">Edit</button>
          <button *ngIf="editingStudent?.studentID === s.studentID" (click)="saveStudent()">Save</button>
          <button *ngIf="editingStudent?.studentID === s.studentID" (click)="cancelEdit()">Cancel</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Leave Requests Section -->
<div *ngIf="leaveRequests.length > 0">
  <h3>Leave Requests</h3>
  <table>
    <thead>
      <tr>
        <th>Student</th>
        <th>From</th>
        <th>To</th>
        <th>Reason</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let r of leaveRequests">
        <td>{{ r.studentName }}</td>
        <td>{{ r.fromDate | date }}</td>
        <td>{{ r.toDate | date }}</td>
        <td>{{ r.reason }}</td>
        <td>{{ r.status }}</td>
        <td>
          <button *ngIf="r.status === 'Pending'" (click)="updateLeaveStatus(r.leaveId, 'Approved')">Approve</button>
          <button *ngIf="r.status === 'Pending'" (click)="updateLeaveStatus(r.leaveId, 'Rejected')">Reject</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
